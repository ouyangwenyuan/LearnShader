## Unity 的基础光照
漫反射模型：
兰伯特光照模型：
遵循兰伯特定律：在平面某点漫反射的光强度与该反射点的法向量和入射光角度的余弦值成正比。

逐顶点光照（也叫高洛德着色（Gouraud shading））
逐像素光照（也叫 冯氏插值或者法线插值着色技术（phong shading）），用于模拟光滑表面的光照效果。

通过比较逐顶点光照和逐像素光照的渲染结果，可以发现，逐像素光照可以得到更加平滑的效果，在逐像素光照中，我们会以每个像素为基础，得到它的法线（可以是对顶点法线插值得到，也可以是从法线纹理中采用得到）然后进行光照模型计算
这种在片元之间对顶点法线进行插值的技术成为phong 着色。与之对应的逐顶点光照，也称高洛德着色，我们在每个顶点上计算光照，然后会在渲染图元内部进行线性插值，最后输出成像素的颜色，由于顶点数目往往远小于像素数目，因此逐顶点光照的计算量
往往小于逐像素光照，但是由于逐顶点光照依赖于线性插值来得到像素光照，因此当光照模型有非线性计算（例如计算高光反射时），逐顶点光照就会产生明显的棱角现象。

半兰伯特模型
与兰伯特模型相比，半兰伯特模型没有使用max操作来防止法线和光照方向的点积为负值。而是对其结果进行了一个a倍的缩放再加上一个b大小的偏移，大多数情况下，a ,b的值均未0.5，将法线和光照方向的点积结果从[-1,1]映射到 [0,1]范围内。
半兰伯特模型没有任何物理依据，它仅仅是一个视觉增强技术。
在兰伯特模型中，在光照无法到达的区域，模型外观是全黑的，没有任何明暗变化，而半兰伯特模型则没有这样的问题。

高光反射模型：
对于高光反射部分，我们首先计算了入射光线方向关于表面法线的反射方向reflectDir。由于Cg的reflect函数的入射方向要求是由光源指向交点处的， 因此我们需要对worldLightDir取反后再传给reflect函数。然后，我们通过_WorldSpaceCameraPos得到了世界空间中的摄像机位置，再把顶点位置从模型空间变换到世界空间下，再通过和 _WorldSpaceCameraPos相减即可得到世界空间下的视角方向。

使用逐顶点的方法得到的高光效果有比较大的问题，我们可以在图6.10中看出高光部分明显不平滑。这主要是因为，高光反射部分的计算是非线性的，而在顶点着色器中计算光照再进行插值的过程 是线性的，破坏了原计算的非线性关系，就会出现较大的视觉问题。因此，我们就需要使用逐像素的方法来计算高光反射。

UnityCG.cginc中一些常用的帮助函数
float3 WorldSpaceViewDir (float4 v)  //输入一个模型空间中的顶点位置，返回世界空间中从该点到摄像机的观察方向。内部实现使用了UnityWorldSpaceViewDir函数
float3 UnityWorldSpaceViewDir (float4 v) 输入一个世界空间中的顶点位置，返回世界空间中从该点到摄像机的观察方向
float3 ObjSpaceViewDir (float4 v) //输入一个模型空间中的顶点位置，返回模型空间中从该点到摄像机的观察方向
float3 WorldSpaceLightDir (float4 v) 仅可用于前向渲染中 。输入一个模型空间中的顶点位置，返回世界空间中从该点到光源的光照方向。内部实现使用了UnityWorldSpaceLightDir函数。没有被归一化
float3 UnityWorldSpaceLightDir (float4 v) // 仅可用于前向渲染中 。输入一个世界空间中的顶点位置，返回世界空间中从该点到光源的光照方向。没有被归一化
float3 ObjSpaceLightDir (float4 v) 仅可用于前向渲染中 。输入一个模型空间中的顶点位置，返回模型空间中从该点到光源的光照方向。没有被归一化
float3 UnityObjectToWorldNormal (float3 norm) // 把法线方向从模型空间转换到世界空间中
float3 UnityObjectToWorldDir (float3 dir) 把方向矢量从模型空间变换到世界空间中
float3 UnityWorldToObjectDir(float3 dir) // 把方向矢量从世界空间变换到模型空间中
